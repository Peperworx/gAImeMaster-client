<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>gAImeMaster Client</title>
    <link rel="stylesheet" href="dep/slick/slick.css">
    <link rel="stylesheet" href="dep/noty/noty.css">
    <link rel="stylesheet" href="dep/noty/themes/metroui.css">
    <link rel="stylesheet" href="dep/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="dep/iziModal-master/css/iziModal.css">
    <link rel="stylesheet" href="dep/w3.css">
    <link rel="stylesheet" href="main.css">
</head>

<body>
    <script>
        const developer = true;
        const electron = require('electron');
        const customTitlebar = require('custom-electron-titlebar');
        const mmenu = new electron.remote.Menu();

        mmenu.append(new electron.remote.MenuItem({
            label: 'Account',
            submenu: [{
                label: "Logout",
                click: function() {
                    location.href = "logout.html";
                }
            }]
        }));
        if (localStorage.getItem("developer") == "true") {
            mmenu.append(new electron.remote.MenuItem({
                label: 'Developer',
                submenu: [{
                    label: "Reload Page",
                    click: function() {
                        location.reload();
                    }
                }]
            }));
        }
        window.titlebr = new customTitlebar.Titlebar({
            backgroundColor: customTitlebar.Color.fromHex('#222'),
            drag: true,
            menu: mmenu,
            maximizable: false
        });
    </script>
    <div class="container">
        <div class="row">
            <div class="card col-lg-3 col-style-1 w3-center">
                <h3>Characters</h3>
                <p>Click the button to create and view characters!</p>
                <a class="w3-button bottom-col hover-dark" href="/play/characters.html">Characters</a>
                <br>
                <p></p>
            </div>
            <div class="card col-lg-5 col-style-1 w3-center">
                <h3>Play game</h3>
                <p>Click the button to invite friends to start or resume an adventure!</p>
                <a class="w3-button bottom-col hover-dark" href="play.html" id="partyStart">Play Game</a>
                <p></p>
            </div>
            <div class="card col-lg-3 col-style-1 w3-center">
                <h3>Add friends</h3>
                <p>Click here to add a friend!</p>
                <a class="w3-button bottom-col hover-dark" href="/play/friends/">Add friends</a>
                <br>
                <p></p>
            </div>

        </div>
    </div>
    <script>
        if (typeof module === 'object') {
            window.module = module;
            module = undefined;
        }
    </script>
    <script src="dep/jquery.js"></script>
    <script src="dep/noty/noty.js"></script>
    <script src="dep/slick/slick.js"></script>
    <script src="dep/iziModal-master/js/iziModal.min.js"></script>
    <script src="dep/bootstrap/js/bootstrap.js"></script>
    <script src="dep/socket.io.js"></script>
    <script>
        if (window.module) {
            module = window.module;
        }
    </script>
    <script>
        $("a").click(function(e) {
            window.titlebr.dispose();
        });
        var socket = io("http://localhost:3435")
        socket.emit("checkIn", localStorage.getItem("username"))
        socket.on("invitedToParty", function(data) {
            var notification = new Notification(`You have been invited to join a party by ${data["OwnerUNAME"]}. Click on this notification to accept.`);
            notification.onclick = function() {
                alert("Accepted invite.");
            };
            /*
            var n = new Noty({
                layout: "bottomRight",
                theme: "metroui",
                text: data["OwnerUNAME"] + " has invited you to party. Do you accept?",
                buttons: [
                    Noty.button('Accept', "btn btn-outline-dark", function() {
                        location.href = "/play/party?id=" + data["PartyID"]
                        }),
                           Noty.button('Decline', "btn", function() {
                              n.close();
                        })
                    ]
                });
            n.show();*/
        });

        function notifyMe() {
            // Let's check if the browser supports notifications
            if (!("Notification" in window)) {
                alert("This device does not support desktop notifications");
            }

            // Let's check whether notification permissions have already been granted
            else if (Notification.permission === "granted") {
                // If it's okay let's create a notification
                var notification = new Notification("Hi there!");
            }

            // Otherwise, we need to ask the user for permission
            else if (Notification.permission !== "denied") {
                Notification.requestPermission().then(function(permission) {
                    // If the user accepts, let's create a notification
                    if (permission === "granted") {
                        var notification = new Notification("Hi there!");
                    }
                });
            }

            // At last, if the user has denied notifications, and you 
            // want to be respectful there is no need to bother them any more.
        }
    </script>

    <script>
    </script>

</body>

</html>